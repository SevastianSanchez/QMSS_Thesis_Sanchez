) +
theme(plot.title = element_text(size = 14))+
theme_minimal()
# Save to specific folder
ggsave("component_2/figures/stage2/sdg_di_s2_scatterplot.png", sdg_di_s2_scatter, width = 8, height = 6)
# side by side comparison using patchwork
library(patchwork)
sdg_spi_s2_scatter + sdg_di_s2_scatter + plot_layout(ncol = 2)
ggsave("component_2/figures/stage2/s2_scatterplots.png", width = 12, height = 8)
# Chunk 7
# Contemporaneous Effect: SDG ~ SPI + DI
fd_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi, vcov = vcovHC(fd_sdg_spi, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
fd_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ di_score + plm::lag(di_score, 1)
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi_L1, vcov = vcovHC(fd_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fd_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp
+ plm::lag(spi_comp, 1) + plm::lag(spi_comp, 2)
+ di_score + plm::lag(di_score, 1) + plm::lag(di_score, 2)
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi_L2, vcov = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1"))
# CI
coef <- coef(fd_sdg_spi_L2)
se <- sqrt(diag(vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")))  # Get standard errors
crit_value <- qt(0.975, df = nobs(fd_sdg_spi_L2)-length(coef(fd_sdg_spi_L2)))
ci_low <- coef - crit_value * se
ci_high <- coef + crit_value * se
cbind(ci_low, ci_high)
# Joint significance FD - DI scores
linearHypothesis(
fd_sdg_spi_L2,
c("di_score = 0", "plm::lag(di_score, 1) = 0", "plm::lag(di_score, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fd_sdg_spi_L2))
# Joint significance FD - SPI scores
linearHypothesis(
fd_sdg_spi_L2,
c("spi_comp = 0", "plm::lag(spi_comp, 1) = 0", "plm::lag(spi_comp, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fd_sdg_spi_L2))
# Contemporaneous Effect: SDG ~ SPI + DI
fe_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
data = panel_data,
model = "within" #FE
)
summary(fe_sdg_spi, vcov = vcovHC(fe_sdg_spi, cluster = "group", type = "HC1")) # Robust SEs
# Adding Lag1: SPI ~ DI
fe_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ di_score + plm::lag(di_score, 1)
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "within",
data = panel_data)
summary(fe_sdg_spi_L1, vcov = vcovHC(fe_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fe_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ plm::lag(spi_comp, 2) + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "within",
data = panel_data)
summary(fe_sdg_spi_L2, vcov = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1"))
# CI for FE model with Lag2
coef <- coef(fe_sdg_spi_L2)
se <- sqrt(diag(vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")))  # Get standard errors
crit_value <- qt(0.975, df = nobs(fe_sdg_spi_L2)-length(coef(fe_sdg_spi_L2)))
ci_low <- coef - crit_value * se
ci_high <- coef + crit_value * se
cbind(ci_low, ci_high)
# Joint significance FE - DI scores
linearHypothesis(
fe_sdg_spi_L2,
c("di_score = 0", "plm::lag(di_score, 1) = 0", "plm::lag(di_score, 2) = 0"),
vcov. = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fe_sdg_spi_L2))
# Joint significance FE - DI scores
linearHypothesis(
fe_sdg_spi_L2,
c("spi_comp = 0", "plm::lag(spi_comp, 1) = 0", "plm::lag(spi_comp, 2) = 0"),
vcov. = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fe_sdg_spi_L2))
# Contemporaneous Effect: SDG ~ SPI + DI
fe_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
data = panel_data,
model = "within" #FE
)
summary(fe_sdg_spi, vcov = vcovHC(fe_sdg_spi, cluster = "group", type = "HC1")) # Robust SEs
# Adding Lag1: SPI ~ DI
fe_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ di_score + plm::lag(di_score, 1)
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "within",
data = panel_data)
summary(fe_sdg_spi_L1, vcov = vcovHC(fe_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fe_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ plm::lag(spi_comp, 2) + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "within",
data = panel_data)
summary(fe_sdg_spi_L2, vcov = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1"))
# CI for FE model with Lag2
coef <- coef(fe_sdg_spi_L2)
se <- sqrt(diag(vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")))  # Get standard errors
crit_value <- qt(0.975, df = nobs(fe_sdg_spi_L2)-length(coef(fe_sdg_spi_L2)))
ci_low <- coef - crit_value * se
ci_high <- coef + crit_value * se
cbind(ci_low, ci_high)
# Joint significance FE - DI scores
linearHypothesis(
fe_sdg_spi_L2,
c("di_score = 0", "plm::lag(di_score, 1) = 0", "plm::lag(di_score, 2) = 0"),
vcov. = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fe_sdg_spi_L2))
# Joint significance FE - DI scores
linearHypothesis(
fe_sdg_spi_L2,
c("spi_comp = 0", "plm::lag(spi_comp, 1) = 0", "plm::lag(spi_comp, 2) = 0"),
vcov. = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fe_sdg_spi_L2))
citation(car)
citation('car')
# Chunk 1
knitr::opts_chunk$set(
echo = TRUE, warning = FALSE, message = FALSE,
tidy = TRUE, tidy.opts = list(width.cutoff = 60)
)
# Chunk 2
# set working directory
setwd("~/Documents/GitHub/QMSS_Thesis_Sanchez")
#load libraries/packages
source("packages.R")
# load data
source("Comp2_panel_wrangling.R")
# select relevant variables and arrange data
panel_data1 <- panel_data %>%
dplyr::select(country_name, country_code, year, sdg_overall, spi_comp,
di_score, log_gdppc, income_level_recoded) %>%
dplyr::arrange(country_code, year)
# how many countries
length(unique(panel_data1$country_code))
# Chunk 3
panel_data <- pdata.frame(panel_data1, index = c("country_code", "year"))
pdim(panel_data) # check panel dimensions
# Chunk 4
# Contemporaneous Effect: SDG ~ SPI + DI
ols_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score + log_gdppc
+ factor(income_level_recoded) + factor(year),
model = "pooling",
data = panel_data)
summary(ols_sdg_spi, vcov = vcovHC(ols_sdg_spi, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
ols_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ di_score + plm::lag(di_score, 1)
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "pooling",
data = panel_data)
summary(ols_sdg_spi_L1, vcov = vcovHC(ols_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
ols_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ plm::lag(spi_comp, 2) + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "pooling",
data = panel_data)
summary(ols_sdg_spi_L2, vcov = vcovHC(ols_sdg_spi_L2, cluster = "group", type = "HC1"))
# Chunk 5
# Contemporaneous Relationship: SDG ~ SPI
sdg_spi_s2_scatter <- ggplot(panel_data1, aes(x = spi_comp, y = sdg_overall)) +
geom_point(color = "steelblue4", size = 1, alpha = 0.65) +
geom_smooth(method = "lm",
se = TRUE, color = "darkgreen", size = 1) +
labs(
title = "Effect of Statistical Capacity on SDG Performance",
x = "SPI Composite (0-100 Scale)",
y = "SDG Composite (0-100 Scale)"
) +
theme(plot.title = element_text(size = 14))+
theme_minimal()
# Save to specific folder
ggsave("component_2/figures/stage2/sdg_spi_s2_scatterplot.png", sdg_spi_s2_scatter, width = 8, height = 6)
# Contemporaneous Relationship: SDG ~ DI
sdg_di_s2_scatter <- ggplot(panel_data1, aes(x = di_score, y = sdg_overall)) +
geom_point(color = "steelblue4", size = 1, alpha = 0.65) +
geom_smooth(method = "lm",
se = TRUE, color = "#f27405", size = 1) +
labs(
title = "Effect of Democracy Levels on SDG Performance",
x = "DI Composite (0-10 Scale)",
y = "SDG Composite (0-100 Scale)"
) +
theme(plot.title = element_text(size = 14))+
theme_minimal()
# Save to specific folder
ggsave("component_2/figures/stage2/sdg_di_s2_scatterplot.png", sdg_di_s2_scatter, width = 8, height = 6)
# side by side comparison using patchwork
library(patchwork)
sdg_spi_s2_scatter + sdg_di_s2_scatter + plot_layout(ncol = 2)
ggsave("component_2/figures/stage2/s2_scatterplots.png", width = 12, height = 8)
# Contemporaneous Effect: SDG ~ SPI + DI
fd_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi, vcov = vcovHC(fd_sdg_spi, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
fd_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ di_score + plm::lag(di_score, 1)
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi_L1, vcov = vcovHC(fd_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fd_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp
+ plm::lag(spi_comp, 1) + plm::lag(spi_comp, 2)
+ di_score + plm::lag(di_score, 1) + plm::lag(di_score, 2)
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi_L2, vcov = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1"))
# CI
coef <- coef(fd_sdg_spi_L2)
se <- sqrt(diag(vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")))  # Get standard errors
crit_value <- qt(0.975, df = nobs(fd_sdg_spi_L2)-length(coef(fd_sdg_spi_L2)))
ci_low <- coef - crit_value * se
ci_high <- coef + crit_value * se
cbind(ci_low, ci_high)
# Joint significance FD - DI scores
linearHypothesis(
fd_sdg_spi_L2,
c("di_score = 0", "plm::lag(di_score, 1) = 0", "plm::lag(di_score, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fd_sdg_spi_L2))
# Joint significance FD - SPI scores
linearHypothesis(
fd_sdg_spi_L2,
c("spi_comp = 0", "plm::lag(spi_comp, 1) = 0", "plm::lag(spi_comp, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fd_sdg_spi_L2))
# Contemporaneous Effect: SDG ~ SPI + DI
fd_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi, vcov = vcovHC(fd_sdg_spi, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
fd_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ di_score + plm::lag(di_score, 1)
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi_L1, vcov = vcovHC(fd_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fd_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp
+ plm::lag(spi_comp, 1) + plm::lag(spi_comp, 2)
+ di_score + plm::lag(di_score, 1) + plm::lag(di_score, 2)
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi_L2, vcov = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1"))
# CI
coef <- coef(fd_sdg_spi_L2)
se <- sqrt(diag(vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")))  # Get standard errors
crit_value <- qt(0.975, df = nobs(fd_sdg_spi_L2)-length(coef(fd_sdg_spi_L2)))
ci_low <- coef - crit_value * se
ci_high <- coef + crit_value * se
cbind(ci_low, ci_high)
# Joint significance FD - DI scores
linearHypothesis(
fd_sdg_spi_L2,
c("di_score = 0", "plm::lag(di_score, 1) = 0", "plm::lag(di_score, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fd_sdg_spi_L2))
# Joint significance FD - SPI scores
linearHypothesis(
fd_sdg_spi_L2,
c("spi_comp = 0", "plm::lag(spi_comp, 1) = 0", "plm::lag(spi_comp, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fd_sdg_spi_L2))
# Chunk 1
knitr::opts_chunk$set(
echo = TRUE, warning = FALSE, message = FALSE,
tidy = TRUE, tidy.opts = list(width.cutoff = 60)
)
# Chunk 2
# set working directory
setwd("~/Documents/GitHub/QMSS_Thesis_Sanchez")
#load libraries/packages
source("packages.R")
# load data
source("Comp2_panel_wrangling.R")
# select relevant variables and arrange data
panel_data1 <- panel_data %>%
dplyr::select(country_name, country_code, year, sdg_overall, spi_comp,
di_score, log_gdppc, income_level_recoded) %>%
dplyr::arrange(country_code, year)
# how many countries
length(unique(panel_data1$country_code))
# Chunk 3
panel_data <- pdata.frame(panel_data1, index = c("country_code", "year"))
pdim(panel_data) # check panel dimensions
# Chunk 4
# Contemporaneous Effect: SDG ~ SPI + DI
ols_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score + log_gdppc
+ factor(income_level_recoded) + factor(year),
model = "pooling",
data = panel_data)
summary(ols_sdg_spi, vcov = vcovHC(ols_sdg_spi, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
ols_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ di_score + plm::lag(di_score, 1)
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "pooling",
data = panel_data)
summary(ols_sdg_spi_L1, vcov = vcovHC(ols_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
ols_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ plm::lag(spi_comp, 2) + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "pooling",
data = panel_data)
summary(ols_sdg_spi_L2, vcov = vcovHC(ols_sdg_spi_L2, cluster = "group", type = "HC1"))
# Chunk 5
# Contemporaneous Relationship: SDG ~ SPI
sdg_spi_s2_scatter <- ggplot(panel_data1, aes(x = spi_comp, y = sdg_overall)) +
geom_point(color = "steelblue4", size = 1, alpha = 0.65) +
geom_smooth(method = "lm",
se = TRUE, color = "darkgreen", size = 1) +
labs(
title = "Effect of Statistical Capacity on SDG Performance",
x = "SPI Composite (0-100 Scale)",
y = "SDG Composite (0-100 Scale)"
) +
theme(plot.title = element_text(size = 14))+
theme_minimal()
# Save to specific folder
ggsave("component_2/figures/stage2/sdg_spi_s2_scatterplot.png", sdg_spi_s2_scatter, width = 8, height = 6)
# Contemporaneous Relationship: SDG ~ DI
sdg_di_s2_scatter <- ggplot(panel_data1, aes(x = di_score, y = sdg_overall)) +
geom_point(color = "steelblue4", size = 1, alpha = 0.65) +
geom_smooth(method = "lm",
se = TRUE, color = "#f27405", size = 1) +
labs(
title = "Effect of Democracy Levels on SDG Performance",
x = "DI Composite (0-10 Scale)",
y = "SDG Composite (0-100 Scale)"
) +
theme(plot.title = element_text(size = 14))+
theme_minimal()
# Save to specific folder
ggsave("component_2/figures/stage2/sdg_di_s2_scatterplot.png", sdg_di_s2_scatter, width = 8, height = 6)
# side by side comparison using patchwork
library(patchwork)
sdg_spi_s2_scatter + sdg_di_s2_scatter + plot_layout(ncol = 2)
ggsave("component_2/figures/stage2/s2_scatterplots.png", width = 12, height = 8)
# Chunk 7
# Contemporaneous Effect: SDG ~ SPI + DI
fd_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi, vcov = vcovHC(fd_sdg_spi, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
fd_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ di_score + plm::lag(di_score, 1)
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi_L1, vcov = vcovHC(fd_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fd_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp
+ plm::lag(spi_comp, 1) + plm::lag(spi_comp, 2)
+ di_score + plm::lag(di_score, 1) + plm::lag(di_score, 2)
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = fd_data)
summary(fd_sdg_spi_L2, vcov = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1"))
# CI
coef <- coef(fd_sdg_spi_L2)
se <- sqrt(diag(vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")))  # Get standard errors
crit_value <- qt(0.975, df = nobs(fd_sdg_spi_L2)-length(coef(fd_sdg_spi_L2)))
ci_low <- coef - crit_value * se
ci_high <- coef + crit_value * se
cbind(ci_low, ci_high)
# Joint significance FD - DI scores
linearHypothesis(
fd_sdg_spi_L2,
c("di_score = 0", "plm::lag(di_score, 1) = 0", "plm::lag(di_score, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fd_sdg_spi_L2))
# Joint significance FD - SPI scores
linearHypothesis(
fd_sdg_spi_L2,
c("spi_comp = 0", "plm::lag(spi_comp, 1) = 0", "plm::lag(spi_comp, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fd_sdg_spi_L2))
# Contemporaneous Effect: SDG ~ SPI + DI
fe_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
data = panel_data,
model = "within" #FE
)
summary(fe_sdg_spi, vcov = vcovHC(fe_sdg_spi, cluster = "group", type = "HC1")) # Robust SEs
# Adding Lag1: SPI ~ DI
fe_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ di_score + plm::lag(di_score, 1)
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "within",
data = panel_data)
summary(fe_sdg_spi_L1, vcov = vcovHC(fe_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fe_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ plm::lag(spi_comp, 2) + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "within",
data = panel_data)
summary(fe_sdg_spi_L2, vcov = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1"))
# CI for FE model with Lag2
coef <- coef(fe_sdg_spi_L2)
se <- sqrt(diag(vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")))  # Get standard errors
crit_value <- qt(0.975, df = nobs(fe_sdg_spi_L2)-length(coef(fe_sdg_spi_L2)))
ci_low <- coef - crit_value * se
ci_high <- coef + crit_value * se
cbind(ci_low, ci_high)
# Joint significance FE - DI scores
linearHypothesis(
fe_sdg_spi_L2,
c("di_score = 0", "plm::lag(di_score, 1) = 0", "plm::lag(di_score, 2) = 0"),
vcov. = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fe_sdg_spi_L2))
# Joint significance FE - DI scores
linearHypothesis(
fe_sdg_spi_L2,
c("spi_comp = 0", "plm::lag(spi_comp, 1) = 0", "plm::lag(spi_comp, 2) = 0"),
vcov. = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fe_sdg_spi_L2))
citation('tidyverse')
