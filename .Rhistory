#ggsave("component_2/figures/stage2/s2_scatterplots.png", width = 12, height = 8)
# Chunk 7
# Contemporaneous Effect: SDG ~ SPI + DI
fd_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = panel_data)
summary(fd_sdg_spi, vcov = vcovHC(fd_sdg_spi, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
fd_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ di_score + plm::lag(di_score, 1)
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = panel_data)
summary(fd_sdg_spi_L1, vcov = vcovHC(fd_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fd_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp
+ plm::lag(spi_comp, 1) + plm::lag(spi_comp, 2)
+ di_score + plm::lag(di_score, 1) + plm::lag(di_score, 2)
+ log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = panel_data)
summary(fd_sdg_spi_L2, vcov = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1"))
# CI
coef <- coef(fd_sdg_spi_L2)
se <- sqrt(diag(vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")))  # Get standard errors
crit_value <- qt(0.975, df = nobs(fd_sdg_spi_L2)-length(coef(fd_sdg_spi_L2)))
ci_low <- coef - crit_value * se
ci_high <- coef + crit_value * se
cbind(ci_low, ci_high)
# Joint significance of DI scores - FD
linearHypothesis(
fd_sdg_spi_L2,
c("di_score = 0", "plm::lag(di_score, 1) = 0", "plm::lag(di_score, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fd_sdg_spi_L2))
# cumulative effects of DI scores - FD
linearHypothesis(
fd_sdg_spi_L2,
c("di_score + plm::lag(di_score, 1) + plm::lag(di_score, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# Joint significance of SPI scores - FD
linearHypothesis(
fd_sdg_spi_L2,
c("spi_comp = 0", "plm::lag(spi_comp, 1) = 0", "plm::lag(spi_comp, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fd_sdg_spi_L2))
# cumulative effects of SPI scores - FD
linearHypothesis(
fd_sdg_spi_L2,
c("spi_comp + plm::lag(spi_comp, 1) + plm::lag(spi_comp, 2) = 0"),
vcov. = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1")
)
# Chunk 9
# Extract coefficients and robust standard errors from the FD model
coefs_fd <- summary(fd_sdg_spi_L2, vcov = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1"))$coefficients
# Create a data frame for visualization
coef_df_fd <- data.frame(
term = rownames(coefs_fd),
estimate = coefs_fd[, "Estimate"],
std.error = coefs_fd[, "Std. Error"]
)
# Create a ggplot error bar chart for the FD model
ebar_fd <- ggplot(coef_df_fd, aes(x = term, y = estimate)) +
geom_point() +
coord_flip() +
geom_hline(yintercept = 0, linetype = "dashed", color = "steelblue") +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error),
width = 0.2) +
labs(title = "Stage II: Static & Lagged TWFE (SDG ~ SPI + DI)",
x = NULL,
y = "Coefficient Estimate") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_x_discrete(labels = c("di_score" = "Democracy (DI)",
"plm::lag(di_score, 1)" = "Lagged DI (t-1)",
"plm::lag(di_score, 2)" = "Lagged DI (t-2)",
"spi_comp" = "Statistical Performance (SPI)",
"plm::lag(spi_comp, 1)" = "Lagged SPI (t-1)",
"plm::lag(spi_comp, 2)" = "Lagged SPI (t-2)",
"log_gdppc" = "Log(GDP per capita)"
),
limits = c(
"di_score",
"plm::lag(di_score, 1)",
"plm::lag(di_score, 2)",
"spi_comp",
"plm::lag(spi_comp, 1)",
"plm::lag(spi_comp, 2)",
"log_gdppc"
))
ebar_fd
# Save the plot
#ggsave("component_2/figures/stage2/error_bar_fd_sdg_spi_L2.png", ebar_fd, width = 10, height = 6)
# Chunk 10
# Contemporaneous Effect: SDG ~ SPI + DI
fe_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
data = panel_data,
model = "within" #FE
)
summary(fe_sdg_spi, vcov = vcovHC(fe_sdg_spi, cluster = "group", type = "HC1")) # Robust SEs
# Adding Lag1: SPI ~ DI
fe_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ di_score + plm::lag(di_score, 1)
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "within",
data = panel_data)
summary(fe_sdg_spi_L1, vcov = vcovHC(fe_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fe_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ plm::lag(spi_comp, 2) + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "within",
data = panel_data)
summary(fe_sdg_spi_L2, vcov = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1"))
# CI for all variables (L2 model)
coef <- coef(fe_sdg_spi_L2)
se <- sqrt(diag(vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")))  # Get standard errors
crit_value <- qt(0.975, df = nobs(fe_sdg_spi_L2)-length(coef(fe_sdg_spi_L2)))
ci_low <- coef - crit_value * se
ci_high <- coef + crit_value * se
cbind(ci_low, ci_high)
# Joint significance FE - DI scores
linearHypothesis(
fe_sdg_spi_L2,
c("di_score = 0", "plm::lag(di_score, 1) = 0", "plm::lag(di_score, 2) = 0"),
vcov. = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fe_sdg_spi_L2))
# cumulative effects of DI scores - FE
linearHypothesis(
fe_sdg_spi_L2,
c("di_score + plm::lag(di_score, 1) + plm::lag(di_score, 2) = 0"),
vcov. = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")
)
# Joint significance FE - DI scores
linearHypothesis(
fe_sdg_spi_L2,
c("spi_comp = 0", "plm::lag(spi_comp, 1) = 0", "plm::lag(spi_comp, 2) = 0"),
vcov. = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")
)
# cumulative effects of SPI scores - FE
linearHypothesis(
fe_sdg_spi_L2,
c("spi_comp + plm::lag(spi_comp, 1) + plm::lag(spi_comp, 2) = 0"),
vcov. = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1")
)
# ensure correct names
# names(coef(fe_sdg_spi_L2))
# Chunk 12
# Extract coefficients and robust standard errors from the FE model
coefs <- summary(fe_sdg_spi_L2, vcov = vcovHC(fe_sdg_spi_L2, cluster = "group",
type = "HC1"))$coefficients
# Create a data frame for visualization
coef_df <- data.frame(
term = rownames(coefs),
estimate = coefs[, "Estimate"],
std.error = coefs[, "Std. Error"]
)
# Create a ggplot error bar chart
ebar_fe <- ggplot(coef_df, aes(x = term, y = estimate)) +
geom_point() +
coord_flip() +
geom_hline(yintercept = 0, linetype = "dashed", color = "steelblue") +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error),
width = 0.2) +
labs(title = "Stage II: Static & Lagged TWFE (SDG ~ SPI + DI)",
x = NULL,
y = "Coefficient Estimate") +
theme_minimal() +
theme(axis.text.x = element_text(hjust = 1)) +
scale_x_discrete(labels = c("di_score" = "Democracy (DI)",
"plm::lag(di_score, 1)" = "Lagged DI (t-1)",
"plm::lag(di_score, 2)" = "Lagged DI (t-2)",
"spi_comp" = "Statistical Performance (SPI)",
"plm::lag(spi_comp, 1)" = "Lagged SPI (t-1)",
"plm::lag(spi_comp, 2)" = "Lagged SPI (t-2)",
"log_gdppc" = "Log(GDP per capita)",
"factor(year)2017" = "Year 2017",
"factor(year)2018" = "Year 2018",
"factor(year)2019" = "Year 2019",
"factor(year)2020" = "Year 2020",
"factor(year)2021" = "Year 2021",
"factor(year)2022" = "Year 2022",
"factor(year)2023" = "Year 2023",
"Intercept" = "Intercept"
),
limits = c(
"di_score",
"plm::lag(di_score, 1)",
"plm::lag(di_score, 2)",
"spi_comp",
"plm::lag(spi_comp, 1)",
"plm::lag(spi_comp, 2)",
"log_gdppc",
"factor(year)2017",
"factor(year)2018",
"factor(year)2019",
"factor(year)2020",
"factor(year)2021",
"factor(year)2022",
"factor(year)2023",
"Intercept"
))
ebar_fe
# Save the plot
#ggsave("component_2/figures/stage2/error_bar_fe_sdg_spi_L2.png", ebar_fe, width = 10, height = 6)
# Chunk 14
# APPLY Wooldridge Test for AR(1) Errors in FE Panel Models: pwartest()
# https://search.r-project.org/CRAN/refmans/plm/html/pwartest.html
# This is MUCH BETTER for panel data with small T AND unbalanced panels!!!
pbgtest(fe_sdg_spi_L2) # Panel
pwartest(fe_sdg_spi_L2) # FE [significant]
pwfdtest(fd_sdg_spi_L2) # FD [not significant]
# Chunk 15
# Apply Breusch-Pagan test for heteroskedasticity
bptest(fe_sdg_spi_L2, studentize = TRUE) # Heteroskedasticity [significant]
bptest(fd_sdg_spi_L2, studentize = TRUE) # Heteroskedasticity [significant]
# Chunk 16
# Extract the data actually used in the base model
ols_base_lm <- lm(sdg_overall ~ spi_comp + di_score + log_gdppc + factor(year), data = panel_data) # regular linear model
model_data2 <- model.frame(ols_base_lm)
# saving all stage-two plots
png("component_2/figures/stage2/all_s2_residual_plots.png", width = 8.5, height = 6.5, units = "in", res = 300)
par(mfrow = c(3, 4))
# Residuals vs Fitted Values plot for ols_base_lm
plot(ols_base_lm, which = 1,
main = "Residuals vs Fitted Model", caption = "ols_base [Stage 2]", pch = 1, cex = 0.35, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals <- fitted(ols_base_lm)
lines(lowess(fitted_vals, resid(ols_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data2$spi_comp, resid(ols_base_lm),
xlab = "spi_comp", ylab = "", yaxt = "n", main = "Residuals vs spi_comp", pch = 1, cex = 0.35, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data2$spi_comp, resid(ols_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data2$di_score, resid(ols_base_lm),
xlab = "di_score", ylab = "", yaxt = "n", main = "Residuals vs di_score", pch = 1, cex = 0.35, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data2$di_score, resid(ols_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc plot
plot(model_data2$log_gdppc, resid(ols_base_lm),
xlab = "log_gdppc", ylab = "", yaxt = "n", main = "Residuals vs log_gdppc", pch = 1, cex = 0.35, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data2$log_gdppc, resid(ols_base_lm)), col = "red", lwd =  1.5)
#dev.off() # to save
#par(mfrow = c(1, 1))
# Chunk 17
# Extract the data actually used in the base model
fd_base_lm <- lm(sdg_diff ~ spi_diff + di_diff + log_gdppc_diff, data = fd_data)
model_data_fd2 <- model.frame(fd_base_lm)
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base [Stage 2]", pch = 1, cex = 0.35, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fd2$spi_diff, resid(fd_base_lm),
xlab = "spi_diff", ylab = "", yaxt = "n", main = "FD Residuals vs spi_comp", pch = 1, cex = 0.35, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$spi_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fd2$di_diff, resid(fd_base_lm),
xlab = "di_diff",  ylab = "", yaxt = "n", main = "FD Residuals vs di_score", pch = 1, cex = 0.35, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$di_diff, resid(fd_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc_diff plot
plot(model_data_fd2$log_gdppc_diff, resid(fd_base_lm),
xlab = "log_gdppc_diff",  ylab = "", yaxt = "n", main = "FD Residuals vs log_gdppc", pch = 1, cex = 0.35, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$log_gdppc_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
#dev.off() # to save
#par(mfrow = c(1, 1))
# Chunk 18
# Extract the data actually used in the base model
fe_base_lm <- lm(sdg_overall ~ spi_comp + di_score + log_gdppc + factor(year) + factor(country_code), data = panel_data)
model_data_fe2 <- model.frame(fe_base_lm)
# Residuals vs Fitted Values plot for fe_base_lm
plot(fe_base_lm, which = 1,
main = "FE Residuals vs Fitted Model", caption = "fe_base [Stage 2]", pch = 1, cex = 0.35, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fe2 <- fitted(fe_base_lm)
lines(lowess(fitted_vals_fe2, resid(fe_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fe2$spi_comp, resid(fe_base_lm),
xlab = "spi_comp", ylab = "", yaxt = "n", main = "FE Residuals vs spi_comp", pch = 1, cex = 0.35, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$spi_comp, resid(fe_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fe2$di_score, resid(fe_base_lm),
xlab = "di_score", ylab = "", yaxt = "n", main = "FE Residuals vs di_score", pch = 1, cex = 0.35, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$di_score, resid(fe_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc plot
plot(model_data_fe2$log_gdppc, resid(fe_base_lm),
xlab = "log_gdppc",  ylab = "", yaxt = "n", main = "FE Residuals vs log_gdppc", pch = 1, cex = 0.35, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$log_gdppc, resid(fe_base_lm)), col = "red", lwd =  1.5)
dev.off() # to save
par(mfrow = c(1, 1))
fd_sdg_spi_test <- plm(formula = sdg_overall ~ spi_comp + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = panel_data)
summary(fd_sdg_spi_test, vcov = vcovHC(fd_sdg_spi_test, cluster = "group", type = "HC1"))
fd_sdg_spi_test <- plm(formula = sdg_overall ~ #spi_comp +
di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = panel_data)
summary(fd_sdg_spi_test, vcov = vcovHC(fd_sdg_spi_test, cluster = "group", type = "HC1"))
fd_sdg_spi_test <- plm(formula = sdg_overall ~ spi_comp +
di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = panel_data)
summary(fd_sdg_spi_test, vcov = vcovHC(fd_sdg_spi_test, cluster = "group", type = "HC1"))
# SDG ~ SPI + DI
fd_sdg_spi_test <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1) +
di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = panel_data)
summary(fd_sdg_spi_test, vcov = vcovHC(fd_sdg_spi_test, cluster = "group", type = "HC1"))
# SDG ~ SPI + DI
fe_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "within",
data = panel_data)
summary(fe_sdg_spi_L2, vcov = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1"))
fe_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ plm::lag(spi_comp, 2) + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "within",
data = panel_data)
summary(fe_sdg_spi_L2, vcov = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1"))
fd_sdg_spi_test <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1) +
di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = panel_data)
summary(fd_sdg_spi_test, vcov = vcovHC(fd_sdg_spi_test, cluster = "group", type = "HC1"))
# SDG ~ SPI + DI
fd_sdg_spi_test <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, n=1) +
di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = panel_data)
summary(fd_sdg_spi_test, vcov = vcovHC(fd_sdg_spi_test, cluster = "group", type = "HC1"))
fd_sdg_spi_test <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, k=1) +
di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = panel_data)
summary(fd_sdg_spi_test, vcov = vcovHC(fd_sdg_spi_test, cluster = "group", type = "HC1"))
fd_sdg_spi_test <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1) +
di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc,
#+ factor(income_level_recoded),
model = "fd",
data = panel_data)
summary(fd_sdg_spi_test, vcov = vcovHC(fd_sdg_spi_test, cluster = "group", type = "HC1"))
length(unique(panel_data1$country_code))
#load libraries/packages
source("packages.R")
# load data
source("Comp2_panel_wrangling.R")
panel_data1 <- panel_data %>%
dplyr::select(country_name, country_code, year, spi_comp, di_score, log_gdppc, sdg_overall, income_level_recoded) %>%
dplyr::arrange(country_code, year)
# how many countries
length(unique(panel_data1$country_code))
# check dimensions
dim(panel_data1)
panel_data <- pdata.frame(panel_data1, index = c("country_code", "year"))
pdim(panel_data) # check panel dimensions
# Lag2: SPI ~ DI [REPORTED]
ols_spi_di_L2 <- plm(
formula = spi_comp ~ di_score + plm::lag(di_score, 1) + plm::lag(di_score, 2)
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "pooling",
data = panel_data)
summary(ols_spi_di_L2, vcov = vcovHC(ols_spi_di_L2, cluster = "group", type = "HC1"))
# how many countries
length(unique(panel_data1$country_code))
# check dimensions
dim(panel_data1)
# rows actually used in the model
model_rows <- rownames(model.frame(ols_spi_di_L2))
used_ids <- unique(panel_data[model_rows, "country_code"])
dropped_ids <- setdiff(unique(panel_data1$country_code), used_ids)
length(used_ids)      # should be 155
length(dropped_ids)   # should be 7
dropped_ids           # which countries are excluded
# Chunk 1
knitr::opts_chunk$set(
echo = TRUE, warning = FALSE, message = FALSE,
tidy = TRUE, tidy.opts = list(width.cutoff = 60)
)
# Chunk 2
# set working directory
setwd("~/Documents/GitHub/QMSS_Thesis_Sanchez")
#load libraries/packages
source("packages.R")
# load data
source("Comp2_panel_wrangling.R")
# select relevant variables and arrange data
panel_data1 <- panel_data %>%
dplyr::select(country_name, country_code, year, sdg_overall, spi_comp,
di_score, log_gdppc, income_level_recoded, di_score_reverse) %>%
dplyr::arrange(country_code, year)
# how many countries
length(unique(panel_data1$country_code))
panel_data <- pdata.frame(panel_data1, index = c("country_code", "year"))
pdim(panel_data) # check panel dimensions
# Adding Lag2: SPI ~ DI
ols_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ plm::lag(spi_comp, 2) + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "pooling",
data = panel_data)
summary(ols_sdg_spi_L2, vcov = vcovHC(ols_sdg_spi_L2, cluster = "group", type = "HC1"))
# rows actually used in the model
model_rows <- rownames(model.frame(ols_sdg_spi_L2))
used_ids <- unique(panel_data[model_rows, "country_code"])
dropped_ids <- setdiff(unique(panel_data1$country_code), used_ids)
length(used_ids)      # should be 155
length(dropped_ids)   # should be 7
dropped_ids           # which countries are excluded
# Chunk 1
knitr::opts_chunk$set(
echo = TRUE, warning = FALSE, message = FALSE,
tidy = TRUE, tidy.opts = list(width.cutoff = 60)
)
# Chunk 2
# set working directory
setwd("~/Documents/GitHub/QMSS_Thesis_Sanchez")
#load libraries/packages
source("packages.R")
# load data
source("Comp2_panel_wrangling.R")
# select relevant variables and arrange data
panel_data1 <- panel_data %>%
dplyr::select(country_name, country_code, year, sdg_overall, spi_comp,
di_score, log_gdppc, income_level_recoded, di_score_reverse) %>%
dplyr::arrange(country_code, year)
# how many countries
length(unique(panel_data1$country_code))
# Chunk 3
panel_data <- pdata.frame(panel_data1, index = c("country_code", "year"))
pdim(panel_data) # check panel dimensions
# Chunk 4
# Adding Lag2: SPI ~ DI
ols_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ plm::lag(spi_comp, 2) + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "pooling",
data = panel_data)
summary(ols_sdg_spi_L2, vcov = vcovHC(ols_sdg_spi_L2, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fe_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + plm::lag(spi_comp, 1)
+ plm::lag(spi_comp, 2) + di_score + plm::lag(di_score, 1)
+ plm::lag(di_score, 2) + log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
model = "within",
data = panel_data)
summary(fe_sdg_spi_L2, vcov = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1"))
# Lag2: SPI ~ DI
fe_spi_di_L2 <- plm(
formula = spi_comp ~ di_score + plm::lag(di_score, 1) + plm::lag(di_score, 2)
+ log_gdppc
#+ factor(income_level_recoded)
+ factor(year),
data = panel_data,
model = "within")
summary(fe_spi_di_L2, vcov = vcovHC(fe_spi_di_L2, cluster = "group", type = "HC1"))
