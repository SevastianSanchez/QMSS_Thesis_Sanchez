lines(lowess(model_data_fe1$di_score, resid(fe_spi_di)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc plot
plot(model_data_fe1$log_gdppc, resid(fe_spi_di),
xlab = "log_gdppc", ylab = "Residuals", main = "FE Residuals vs log_gdppc", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe1$log_gdppc, resid(fe_spi_di)), col = "red", lwd =  1.5)
# Residuals vs Fitted Values plot for fe_spi_di
plot(fe_spi_di, which = 1,
main = "FE Residuals vs Fitted Model", caption = "fe_spi_di [Stage 1]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fe <- fitted(fe_spi_di)
lines(lowess(fitted_vals_fe, resid(fe_spi_di)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fe1$di_score, resid(fe_spi_di),
xlab = "di_score", ylab = "Residuals", main = "FE Residuals vs di_score", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe1$di_score, resid(fe_spi_di)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc plot
plot(model_data_fe1$log_gdppc, resid(fe_spi_di),
xlab = "log_gdppc", ylab = "Residuals", main = "FE Residuals vs log_gdppc", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe1$log_gdppc, resid(fe_spi_di)), col = "red", lwd =  1.5)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fe_spi_di
plot(fe_spi_di, which = 1,
main = "FE Residuals vs Fitted Model", caption = "fe_spi_di [Stage 1]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fe <- fitted(fe_spi_di)
lines(lowess(fitted_vals_fe, resid(fe_spi_di)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fe1$di_score, resid(fe_spi_di),
xlab = "di_score", ylab = "Residuals", main = "FE Residuals vs di_score", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe1$di_score, resid(fe_spi_di)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc plot
plot(model_data_fe1$log_gdppc, resid(fe_spi_di),
xlab = "log_gdppc", ylab = "Residuals", main = "FE Residuals vs log_gdppc", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe1$log_gdppc, resid(fe_spi_di)), col = "red", lwd =  1.5)
# Extract the data actually used in the base model
fe_base_lm <- lm(sdg_overall ~ spi_comp + di_score + log_gdppc + factor(year) + factor(country_code), data = fd_fe_data)
model_data_fe2 <- model.frame(fe_base_lm)
# saving as png
png("figures/fe2_residual_plots.png", width = 8, height = 7, units = "in", res = 300)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fe_base_lm
plot(fe_base_lm, which = 1,
main = "FE Residuals vs Fitted Model", caption = "fe_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fe2 <- fitted(fe_base_lm)
lines(lowess(fitted_vals_fe2, resid(fe_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fe2$spi_comp, resid(fe_base_lm),
xlab = "spi_comp", ylab = "Residuals", main = "FE Residuals vs spi_comp", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$spi_comp, resid(fe_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fe2$di_score, resid(fe_base_lm),
xlab = "di_score", ylab = "Residuals", main = "FE Residuals vs di_score", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$di_score, resid(fe_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc plot
plot(model_data_fe2$log_gdppc, resid(fe_base_lm),
xlab = "log_gdppc", ylab = "Residuals", main = "FE Residuals vs log_gdppc", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$log_gdppc, resid(fe_base_lm)), col = "red", lwd =  1.5)
dev.off() # to save
par(mfrow = c(1, 1))
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fe_base_lm
plot(fe_base_lm, which = 1,
main = "FE Residuals vs Fitted Model", caption = "fe_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fe2 <- fitted(fe_base_lm)
lines(lowess(fitted_vals_fe2, resid(fe_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fe2$spi_comp, resid(fe_base_lm),
xlab = "spi_comp", ylab = "Residuals", main = "FE Residuals vs spi_comp", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$spi_comp, resid(fe_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fe2$di_score, resid(fe_base_lm),
xlab = "di_score", ylab = "Residuals", main = "FE Residuals vs di_score", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$di_score, resid(fe_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc plot
plot(model_data_fe2$log_gdppc, resid(fe_base_lm),
xlab = "log_gdppc", ylab = "Residuals", main = "FE Residuals vs log_gdppc", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$log_gdppc, resid(fe_base_lm)), col = "red", lwd =  1.5)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fe_spi_di
plot(fe_spi_di, which = 1,
main = "FE Residuals vs Fitted Model", caption = "fe_spi_di [Stage 1]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fe <- fitted(fe_spi_di)
lines(lowess(fitted_vals_fe, resid(fe_spi_di)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fe1$di_score, resid(fe_spi_di),
xlab = "di_score", ylab = "Residuals", main = "FE Residuals vs di_score", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe1$di_score, resid(fe_spi_di)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc plot
plot(model_data_fe1$log_gdppc, resid(fe_spi_di),
xlab = "log_gdppc", ylab = "Residuals", main = "FE Residuals vs log_gdppc", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe1$log_gdppc, resid(fe_spi_di)), col = "red", lwd =  1.5)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for ols_base_lm_quad
plot(ols_base_lm_quad, which = 1,
main = "Residuals vs Fitted Model", caption = "ols_base", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals <- fitted(ols_base_lm_quad)
lines(lowess(fitted_vals, resid(ols_base_lm_quad)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data3$spi_comp, resid(ols_base_lm_quad),
xlab = "spi_comp", ylab = "Residuals", main = "Residuals vs spi_comp", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data3$spi_comp, resid(ols_base_lm_quad)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data3$di_score, resid(ols_base_lm_quad),
xlab = "di_score", ylab = "Residuals", main = "Residuals vs di_score", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data3$di_score, resid(ols_base_lm_quad)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc plot
plot(model_data3$quad2_log_gdppc, resid(ols_base_lm_quad),
xlab = "quad2_log_gdppc", ylab = "Residuals", main = "Residuals vs log_gdppc", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data3$quad2_log_gdppc, resid(ols_base_lm_quad)), col = "red", lwd =  1.5)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for ols_base_lm
plot(ols_base_lm, which = 1,
main = "Residuals vs Fitted Model", caption = "ols_base", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals <- fitted(ols_base_lm)
lines(lowess(fitted_vals, resid(ols_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data2$spi_comp, resid(ols_base_lm),
xlab = "spi_comp", ylab = "Residuals", main = "Residuals vs spi_comp", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data2$spi_comp, resid(ols_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data2$di_score, resid(ols_base_lm),
xlab = "di_score", ylab = "Residuals", main = "Residuals vs di_score", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data2$di_score, resid(ols_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc plot
plot(model_data2$log_gdppc, resid(ols_base_lm),
xlab = "log_gdppc", ylab = "Residuals", main = "Residuals vs log_gdppc", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data2$log_gdppc, resid(ols_base_lm)), col = "red", lwd =  1.5)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fe_base_lm
plot(fe_base_lm, which = 1,
main = "FE Residuals vs Fitted Model", caption = "fe_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fe2 <- fitted(fe_base_lm)
lines(lowess(fitted_vals_fe2, resid(fe_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fe2$spi_comp, resid(fe_base_lm),
xlab = "spi_comp", ylab = "Residuals", main = "FE Residuals vs spi_comp", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$spi_comp, resid(fe_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fe2$di_score, resid(fe_base_lm),
xlab = "di_score", ylab = "Residuals", main = "FE Residuals vs di_score", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$di_score, resid(fe_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc plot
plot(model_data_fe2$log_gdppc, resid(fe_base_lm),
xlab = "log_gdppc", ylab = "Residuals", main = "FE Residuals vs log_gdppc", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fe2$log_gdppc, resid(fe_base_lm)), col = "red", lwd =  1.5)
# Just for FD Models - DF
fd_data <- fd_fe_data %>%
select(country_code, year, sdg_overall, di_score, spi_comp, log_gdppc) %>%
filter(!is.na(di_score) & !is.na(spi_comp)) %>%
arrange(country_code, year) %>%
group_by(country_code) %>%
mutate(
# first differences for selected variables
sdg_diff = sdg_overall - dplyr::lag(sdg_overall, n=1),
di_diff = di_score - dplyr::lag(di_score, n=1),
spi_diff = spi_comp - dplyr::lag(spi_comp,n=1),
log_gdppc_diff = log_gdppc - dplyr::lag(log_gdppc, n=1),
# lagged first differences
di_diff_lag1 = dplyr::lag(di_diff, n=1),
di_diff_lag2 = dplyr::lag(di_diff, n=2),
spi_diff_lag1 = dplyr::lag(spi_diff, n=1),
spi_diff_lag2 = dplyr::lag(spi_diff, n=2),
log_gdppc_diff_lag1 = dplyr::lag(log_gdppc_diff, n=1),
log_gdppc_diff_lag1 = dplyr::lag(log_gdppc_diff, n=2)
) %>%
ungroup()
# Extract the data actually used in the model
fd_spi_di <- lm(spi_diff ~ di_diff + log_gdppc_diff, data = fd_data)
model_data_fd1 <- model.frame(fd_spi_di)
# saving as png
png("figures/fd1_residual_plots.png", width = 8, height = 7, units = "in", res = 300)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_spi_di
plot(fd_spi_di, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_spi_di [Stage 1]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd <- fitted(fd_spi_di)
lines(lowess(fitted_vals_fd, resid(fd_spi_di)), col = "red", lwd =  1.5)
# Residuals vs di_diff plot
plot(model_data_fd1$di_diff, resid(fd_spi_di),
xlab = "di_diff", ylab = "Residuals", main = "FD Residuals vs di_diff", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd1$di_diff, resid(fd_spi_di)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc_diff plot
plot(model_data_fd1$log_gdppc_diff, resid(fd_spi_di),
xlab = "log_gdppc_diff", ylab = "Residuals", main = "FD Residuals vs log_gdppc_diff", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd1$log_gdppc_diff, resid(fd_spi_di)), col = "red", lwd =  1.5)
dev.off() # to save
par(mfrow = c(1, 1))
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_spi_di
plot(fd_spi_di, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_spi_di [Stage 1]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd <- fitted(fd_spi_di)
lines(lowess(fitted_vals_fd, resid(fd_spi_di)), col = "red", lwd =  1.5)
# Residuals vs di_diff plot
plot(model_data_fd1$di_diff, resid(fd_spi_di),
xlab = "di_diff", ylab = "Residuals", main = "FD Residuals vs di_diff", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd1$di_diff, resid(fd_spi_di)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc_diff plot
plot(model_data_fd1$log_gdppc_diff, resid(fd_spi_di),
xlab = "log_gdppc_diff", ylab = "Residuals", main = "FD Residuals vs log_gdppc_diff", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd1$log_gdppc_diff, resid(fd_spi_di)), col = "red", lwd =  1.5)
# Extract the data actually used in the base model
fd_base_lm <- lm(sdg_diff ~ spi_diff + di_diff + log_gdppc_diff, data = fd_data)
model_data_fd2 <- model.frame(fd_base_lm)
# saving as png
png("figures/fd2_residual_plots.png", width = 8, height = 7, units = "in", res = 300)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fd2$spi_comp, resid(fd_base_lm),
xlab = "spi_comp", ylab = "Residuals", main = "FD Residuals vs spi_comp", pch = 1, cex = 0.65, col = "darkblue")
# Extract the data actually used in the base model
fd_base_lm <- lm(sdg_diff ~ spi_diff + di_diff + log_gdppc_diff, data = fd_data)
model_data_fd2 <- model.frame(fd_base_lm)
# saving as png
png("figures/fd2_residual_plots.png", width = 8, height = 7, units = "in", res = 300)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fd2$spi_comp, resid(fd_base_lm),
xlab = "spi_comp", ylab = "Residuals", main = "FD Residuals vs spi_comp", pch = 1, cex = 0.65, col = "darkblue")
fd_base_lm <- lm(sdg_diff ~ spi_diff + di_diff + log_gdppc_diff, data = fd_data)
model_data_fd2 <- model.frame(fd_base_lm)
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
fd_base_lm <- lm(sdg_diff ~ spi_diff + di_diff + log_gdppc_diff, data = fd_data)
model_data_fd2 <- model.frame(fd_base_lm)
# saving as png
png("figures/fd2_residual_plots.png", width = 8, height = 7, units = "in", res = 300)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Extract the data actually used in the base model
fd_base_lm <- lm(sdg_diff ~ spi_diff + di_diff + log_gdppc_diff, data = fd_data)
model_data_fd2 <- model.frame(fd_base_lm)
# saving as png
png("figures/fd2_residual_plots.png", width = 8, height = 7, units = "in", res = 300)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fd2$spi_comp, resid(fd_base_lm),
xlab = "spi_comp", ylab = "Residuals", main = "FD Residuals vs spi_comp", pch = 1, cex = 0.65, col = "darkblue")
# Extract the data actually used in the base model
fd_base_lm <- lm(sdg_diff ~ spi_diff + di_diff + log_gdppc_diff, data = fd_data)
model_data_fd2 <- model.frame(fd_base_lm)
# saving as png
png("figures/fd2_residual_plots.png", width = 8, height = 7, units = "in", res = 300)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fd2$spi_diff, resid(fd_base_lm),
xlab = "spi_diff", ylab = "Residuals", main = "FD Residuals vs spi_comp (Difference)", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$spi_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fd2$di_diff, resid(fd_base_lm),
xlab = "di_diff", ylab = "Residuals", main = "FD Residuals vs di_score (Difference)", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$di_diff, resid(fd_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc_diff plot
plot(model_data_fd2$log_gdppc_diff, resid(fd_base_lm),
xlab = "log_gdppc_diff", ylab = "Residuals", main = "FD Residuals vs log_gdppc (Difference)", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$log_gdppc_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
dev.off() # to save
par(mfrow = c(1, 1))
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fd2$spi_diff, resid(fd_base_lm),
xlab = "spi_diff", ylab = "Residuals", main = "FD Residuals vs spi_comp (Difference)", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$spi_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fd2$di_diff, resid(fd_base_lm),
xlab = "di_diff", ylab = "Residuals", main = "FD Residuals vs di_score (Difference)", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$di_diff, resid(fd_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc_diff plot
plot(model_data_fd2$log_gdppc_diff, resid(fd_base_lm),
xlab = "log_gdppc_diff", ylab = "Residuals", main = "FD Residuals vs log_gdppc (Difference)", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$log_gdppc_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
dev.off() # to save
par(mfrow = c(1, 1))
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fd2$spi_diff, resid(fd_base_lm),
xlab = "spi_diff", ylab = "Residuals", main = "FD Residuals vs spi_comp (Difference)", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$spi_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fd2$di_diff, resid(fd_base_lm),
xlab = "di_diff", ylab = "Residuals", main = "FD Residuals vs di_score (Difference)", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$di_diff, resid(fd_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc_diff plot
plot(model_data_fd2$log_gdppc_diff, resid(fd_base_lm),
xlab = "log_gdppc_diff", ylab = "Residuals", main = "FD Residuals vs log_gdppc (Difference)", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$log_gdppc_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fd2$spi_diff, resid(fd_base_lm),
xlab = "spi_diff", ylab = "Residuals", main = "FD Residuals vs spi_comp (Difference)", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$spi_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fd2$di_diff, resid(fd_base_lm),
xlab = "di_diff", ylab = "Residuals", main = "FD Residuals vs di_score (Difference)", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$di_diff, resid(fd_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc_diff plot
plot(model_data_fd2$log_gdppc_diff, resid(fd_base_lm),
xlab = "log_gdppc_diff", ylab = "Residuals", main = "FD Residuals vs log_gdppc (Difference)", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$log_gdppc_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Extract the data actually used in the base model
fd_base_lm <- lm(sdg_diff ~ spi_diff + di_diff + log_gdppc_diff, data = fd_data)
model_data_fd2 <- model.frame(fd_base_lm)
# saving as png
png("figures/fd2_residual_plots.png", width = 8, height = 7, units = "in", res = 300)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fd2$spi_diff, resid(fd_base_lm),
xlab = "spi_diff", ylab = "Residuals", main = "FD Residuals vs spi_comp (Difference)", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$spi_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fd2$di_diff, resid(fd_base_lm),
xlab = "di_diff", ylab = "Residuals", main = "FD Residuals vs di_score (Difference)", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$di_diff, resid(fd_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc_diff plot
plot(model_data_fd2$log_gdppc_diff, resid(fd_base_lm),
xlab = "log_gdppc_diff", ylab = "Residuals", main = "FD Residuals vs log_gdppc (Difference)", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$log_gdppc_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
dev.off() # to save
par(mfrow = c(1, 1))
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fd2$spi_diff, resid(fd_base_lm),
xlab = "spi_diff", ylab = "Residuals", main = "FD Residuals vs spi_comp (Difference)", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$spi_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fd2$di_diff, resid(fd_base_lm),
xlab = "di_diff", ylab = "Residuals", main = "FD Residuals vs di_score (Difference)", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$di_diff, resid(fd_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc_diff plot
plot(model_data_fd2$log_gdppc_diff, resid(fd_base_lm),
xlab = "log_gdppc_diff", ylab = "Residuals", main = "FD Residuals vs log_gdppc (Difference)", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$log_gdppc_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Extract the data actually used in the base model
fd_base_lm <- lm(sdg_diff ~ spi_diff + di_diff + log_gdppc_diff, data = fd_data)
model_data_fd2 <- model.frame(fd_base_lm)
# saving as png
png("figures/fd2_residual_plots.png", width = 8, height = 7, units = "in", res = 300)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs spi_comp plots
plot(model_data_fd2$spi_diff, resid(fd_base_lm),
xlab = "spi_diff", ylab = "Residuals", main = "FD Residuals vs spi_comp (Difference)", pch = 1, cex = 0.65, col = "darkblue")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$spi_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
# Residuals vs di_score plot
plot(model_data_fd2$di_diff, resid(fd_base_lm),
xlab = "di_diff", ylab = "Residuals", main = "FD Residuals vs di_score (Difference)", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$di_diff, resid(fd_base_lm)), col = "red", lwd = 1.5)
# Residuals vs log_gdppc_diff plot
plot(model_data_fd2$log_gdppc_diff, resid(fd_base_lm),
xlab = "log_gdppc_diff", ylab = "Residuals", main = "FD Residuals vs log_gdppc (Difference)", pch = 1, cex = 0.65, col = "darkgreen")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$log_gdppc_diff, resid(fd_base_lm)), col = "red", lwd =  1.5)
dev.off() # to save
par(mfrow = c(1, 1))
# saving as png
png("figures/fd2_residual_plots.png", width = 8, height = 7, units = "in", res = 300)
par(mfrow = c(2, 2))
# Residuals vs Fitted Values plot for fd_base_lm
plot(fd_base_lm, which = 1,
main = "FD Residuals vs Fitted Model", caption = "fd_base_lm [Stage 2]", pch = 1, cex = 0.65, col = "#595959")
abline(h = 0, col = "black", lty = 2, lwd = 1)
fitted_vals_fd2 <- fitted(fd_base_lm)
lines(lowess(fitted_vals_fd2, resid(fd_base_lm)), col = "red", lwd =  1.5)
plot(model_data_fd2$di_diff, resid(fd_base_lm),
xlab = "di_diff", ylab = "Residuals", main = "FD Residuals vs di_score (Difference)", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$di_diff, resid(fd_base_lm)), col = "red", lwd = 1.5)
plot(model_data_fd2$di_diff, resid(fd_base_lm),
xlab = "di_diff", ylab = "Residuals", main = "FD Residuals vs di_score (Difference)", pch = 1, cex = 0.65, col = "darkred")
abline(h = 0, col = "black", lty = 2, lwd = 1)
lines(lowess(model_data_fd2$di_diff, resid(fd_base_lm)), col = "red", lwd = 1.5)
