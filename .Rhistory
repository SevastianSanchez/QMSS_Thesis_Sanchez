model = "pooling",
index = c("country_code", "year"),
data = panel_data_s2)
summary(ols_sdg_spi_L1, vcov = vcovHC(ols_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
ols_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + spi_comp_lag1 + spi_comp_lag2 + di_score + di_score_lag1 + di_score_lag2 + log_gdppc + factor(income_level_recoded) + factor(year),
model = "pooling",
index = c("country_code", "year"),
data = panel_data_s2)
summary(ols_sdg_spi_L2, vcov = vcovHC(ols_sdg_spi_L2, cluster = "group", type = "HC1"))
# Contemporaneous Effect: SDG ~ SPI + DI
fd_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score + log_gdppc + factor(income_level_recoded),
model = "fd",
index = c("country_code", "year"),
data = fd_data)
summary(fd_sdg_spi, vcov = vcovHC(fd_sdg_spi, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
fd_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + spi_comp_lag1 + di_score + di_score_lag1 + log_gdppc + factor(income_level_recoded),
model = "fd",
index = c("country_code", "year"),
data = fd_data)
summary(fd_sdg_spi_L1, vcov = vcovHC(fd_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fd_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + spi_comp_lag1 + spi_comp_lag2 + di_score + di_score_lag1 + di_score_lag2 + log_gdppc + factor(income_level_recoded),
model = "fd",
index = c("country_code", "year"),
data = fd_data)
summary(fd_sdg_spi_L2, vcov = vcovHC(fd_sdg_spi_L2, cluster = "group", type = "HC1"))
# Contemporaneous Effect: SDG ~ SPI + DI
fe_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score + log_gdppc + factor(year) factor(income_level_recoded),
# Contemporaneous Effect: SDG ~ SPI + DI
fe_sdg_spi <- plm(formula = sdg_overall ~ spi_comp + di_score + log_gdppc + factor(year) + factor(income_level_recoded),
index = c("country_code", "year"),
data = panel_data_s2,
model = "within" #FE
)
summary(fe_sdg_spi, vcov = vcovHC(fe_sdg_spi, cluster = "group", type = "HC1")) # Robust SEs
# Adding Lag1: SPI ~ DI
fe_sdg_spi_L1 <- plm(formula = sdg_overall ~ spi_comp + spi_comp_lag1 + di_score + di_score_lag1 + log_gdppc + factor(income_level_recoded) + factor(year),
model = "within",
index = c("country_code", "year"),
data = panel_data_s2)
summary(fe_sdg_spi_L1, vcov = vcovHC(fe_sdg_spi_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fe_sdg_spi_L2 <- plm(formula = sdg_overall ~ spi_comp + spi_comp_lag1 + spi_comp_lag2 + di_score + di_score_lag1 + di_score_lag2 + log_gdppc + factor(income_level_recoded) + factor(year),
model = "within",
index = c("country_code", "year"),
data = panel_data_s2)
summary(fe_sdg_spi_L2, vcov = vcovHC(fe_sdg_spi_L2, cluster = "group", type = "HC1"))
# APPLY Wooldridge Test for AR(1) Errors in FE Panel Models: pwartest()
# https://search.r-project.org/CRAN/refmans/plm/html/pwartest.html
# This is MUCH BETTER for panel data with small T AND unbalanced panels!!!
pwartest(fe_sdg_spi_L2) # [significant]
pwartest(fd_sdg_spi_L2) # [significant]
# Apply Breusch-Pagan test for heteroskedasticity
bptest(fe_sdg_spi_L2, studentize = TRUE) # Heteroskedasticity [significant]
bptest(fd_sdg_spi_L2, studentize = TRUE) # Heteroskedasticity [significant]
getwd()
# set working directory
setwd("~/Documents/GitHub/QMSS_Thesis_Sanchez")
#load libraries/packages
source("packages.R")
# load data
source("Comp2_panel_wrangling.R")
# select path = "data/Main CSV Outputs/merged_cleaned_sdg.csv"
panel_data_s1 <- panel_data %>%
dplyr::select(country_name, country_code, year, spi_comp, di_score, di_score_lag1, di_score_lag2, log_gdppc, spi_comp_lag1, spi_comp_lag2, income_level_recoded) %>%
dplyr::arrange(country_code, year)
head(panel_data_s1)
# check lag structure is correct
head(panel_data_s1[, c("country_code", "year", "spi_comp", "spi_comp_lag1", "spi_comp_lag2",  "di_score", "di_score_lag1", "di_score_lag2")])
dim(panel_data_s1) # 1336 rows, 11 columns
# Chunk 1
# set working directory
setwd("~/Documents/GitHub/QMSS_Thesis_Sanchez")
#load libraries/packages
source("packages.R")
# load data
source("Comp2_panel_wrangling.R")
# select path = "data/Main CSV Outputs/merged_cleaned_sdg.csv"
panel_data_s1 <- panel_data %>%
dplyr::select(country_name, country_code, year, spi_comp, di_score, di_score_lag1, di_score_lag2, log_gdppc, spi_comp_lag1, spi_comp_lag2, income_level_recoded) %>%
dplyr::arrange(country_code, year)
head(panel_data_s1)
# check lag structure is correct
head(panel_data_s1[, c("country_code", "year", "spi_comp", "spi_comp_lag1", "spi_comp_lag2",  "di_score", "di_score_lag1", "di_score_lag2")])
dim(panel_data_s1) # 1336 rows, 11 columns
# Chunk 2
# Contemporaneous Effect: SPI ~ DI
ols_spi_di <- plm(
formula = spi_comp ~ di_score + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
model = "pooling",
data = panel_data_s1)
summary(ols_spi_di, vcov = vcovHC(ols_spi_di, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
ols_spi_di_L1 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
model = "pooling",
data = panel_data_s1)
summary(ols_spi_di_L1, vcov = vcovHC(ols_spi_di_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
ols_spi_di_L2 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + di_score_lag2 + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
model = "pooling",
data = panel_data_s1)
summary(ols_spi_di_L2, vcov = vcovHC(ols_spi_di_L2, cluster = "group", type = "HC1"))
# Chunk 3
# --- POLS MODELS TABLE ---
# Extracting robust standard errors for the two POLS models
rob_se_pols <- list(
coeftest(ols_spi_di, vcov = vcovHC(ols_spi_di, cluster = "group", type = "HC1"))[, 2],
coeftest(ols_spi_di_L1, vcov = vcovHC(ols_spi_di_L1, cluster = "group", type = "HC1"))[, 2],
coeftest(ols_spi_di_L2, vcov = vcovHC(ols_spi_di_L2, cluster = "group", type = "HC1"))[, 2]
)
# Generate the stargazer table for POLS models
stargazer(
ols_spi_di, ols_spi_di_L1, ols_spi_di_L2,
se = rob_se_pols,
type = "html",
out = "figures/s1_pols_lags.html",
title = "Stage I Models: Pooled OLS (Current and Lagged Effects)",
align = TRUE,
dep.var.labels = "SPI Overall Score",
column.labels = c("Contemporaneous", "Lag 1", "Lag 2"),
covariate.labels = c("DI Composite", "Lagged DI (t-1)", "Lagged DI (t-2)",  "Log(GDPper-capita)", "Lower-Middle Income (LMIC)", "Upper-Middle Income (UMIC)", "High Income (HIC)", "Intercept"),
report = "vcs*",
notes = "Robust standard errors clustered by country in parentheses",
omit = "factor\\(year\\)",
model.names = FALSE
)
# Chunk 4
# Contemporaneous Effect: SPI ~ DI
fd_spi_di <- plm(
formula = spi_comp ~ di_score + log_gdppc +  factor(income_level_recoded),
index = c("country_code", "year"),
data = fd_data,
model = "fd"
)
summary(fd_spi_di, vcov = vcovHC(fd_spi_di, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
fd_spi_di_L1 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + log_gdppc + factor(income_level_recoded),
index = c("country_code", "year"),
data = fd_data,
model = "fd"
)
summary(fd_spi_di_L1, vcov = vcovHC(fd_spi_di_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fd_spi_di_L2 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + di_score_lag2 + log_gdppc + factor(income_level_recoded),
index = c("country_code", "year"),
data = fd_data,
model = "fd"
)
summary(fd_spi_di_L2, vcov = vcovHC(fd_spi_di_L2, cluster = "group", type = "HC1"))
# Chunk 5
# --- FD MODELS TABLE ---
# extracting robust standard errors for the three FD models
rob_se_fd <- list(
coeftest(fd_spi_di, vcov = vcovHC(fd_spi_di, cluster = "group", type = "HC1"))[, 2],
coeftest(fd_spi_di_L1, vcov = vcovHC(fd_spi_di_L1, cluster = "group", type = "HC1"))[, 2],
coeftest(fd_spi_di_L2, vcov = vcovHC(fd_spi_di_L2, cluster = "group", type = "HC1"))[, 2]
)
# stargazer table for FD models
stargazer(
fd_spi_di, fd_spi_di_L1, fd_spi_di_L2,
se = rob_se_fd,
type = "html",
out = "figures/s1_fd_lags.html",
title = "Stage I Models: First Difference (Current and Lagged Effects)",
align = TRUE,
dep.var.labels = "SPI Overall Score",
column.labels = c("Contemporaneous", "Lag 1", "Lag 2"),
covariate.labels = c("DI Composite", "Lagged DI (t-1)", "Lagged DI (t-2)",  "Log(GDPper-capita)", "Lower-Middle Income (LMIC)", "Upper-Middle Income (UMIC)", "High Income (HIC)", "Intercept"),
report = "vcs*",
notes = "Robust standard errors clustered by country in parentheses",
omit = "factor\\(year\\)",
model.names = FALSE
)
# Chunk 6
# Contemporaneous Effect: SPI ~ DI
fe_spi_di <- plm(
formula = spi_comp ~ di_score + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
data = panel_data_s1,
model = "within")
summary(fe_spi_di, vcov = vcovHC(fe_spi_di, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
fe_spi_di_L1 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
data = panel_data_s1,
model = "within")
summary(fe_spi_di_L1, vcov = vcovHC(fe_spi_di_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fe_spi_di_L2 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + di_score_lag2 + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
data = panel_data_s1,
model = "within")
summary(fe_spi_di_L2, vcov = vcovHC(fe_spi_di_L2, cluster = "group", type = "HC1"))
# Chunk 7
# --- FE MODELS TABLE ---
# Extracting robust standard errors for the three FE models
rob_se_fe <- list(
coeftest(fe_spi_di, vcov = vcovHC(fe_spi_di, cluster = "group", type = "HC1"))[, 2],
coeftest(fe_spi_di_L1, vcov = vcovHC(fe_spi_di_L1, cluster = "group", type = "HC1"))[, 2],
coeftest(fe_spi_di_L2, vcov = vcovHC(fe_spi_di_L2, cluster = "group", type = "HC1"))[, 2]
)
# stargazer table for FE models
stargazer(
fe_spi_di, fe_spi_di_L1, fe_spi_di_L2,
se = rob_se_fe,
type = "html",
out = "figures/s1_fe_lags.html",
title = "Stage I Models: Fixed Effects (Current and Lagged Effects)",
align = TRUE,
dep.var.labels = "SPI Overall Score",
column.labels = c("Contemporaneous", "Lag 1", "Lag 2"),
covariate.labels = c("DI Composite", "Lagged DI (t-1)", "Lagged DI (t-2)",  "Log(GDPper-capita)", "Lower-Middle Income (LMIC)", "Upper-Middle Income (UMIC)", "High Income (HIC)", "Intercept"),
report = "vcs*",
notes = "Robust standard errors clustered by country in parentheses",
omit = "factor\\(year\\)",
model.names = FALSE
)
# Chunk 8
# stargazer table for only lag2 models
stargazer(
ols_spi_di_L2, fd_spi_di_L2, fe_spi_di_L2,
se = list(
coeftest(ols_spi_di_L2, vcov = vcovHC(ols_spi_di_L2, cluster = "group", type = "HC1"))[, 2],
coeftest(fd_spi_di_L2, vcov = vcovHC(fd_spi_di_L2, cluster = "group", type = "HC1"))[, 2],
coeftest(fe_spi_di_L2, vcov = vcovHC(fe_spi_di_L2, cluster = "group", type = "HC1"))[, 2]
),
type = "html",
title = "Stage I Models: Lagged Effects (Lag 2)",
align = TRUE,
dep.var.labels = "SPI Overall Score",
column.labels = c("POLS", "FD", "FE"),
covariate.labels = c("DI Composite", "Lagged DI (t-1)", "Lagged DI (t-2)",  "Log(GDPper-capita)", "Lower-Middle Income (LMIC)", "Upper-Middle Income (UMIC)", "High Income (HIC)", "Intercept"),
report = "vcs*",
notes = "Robust standard errors clustered by country in parentheses",
omit = "factor\\(year\\)",
model.names = FALSE,
out = "figures/s1_lag2_mods.html"
)
# Chunk 9
# Extract coefficients and robust standard errors from the FE model
fe_spi_di_L2_results <- summary(fe_spi_di_L2, vcov = vcovHC(fe_spi_di_L2, cluster = "group", type = "HC1"))
# Create a data frame for visualization
coef_df <- data.frame(
term = rownames(fe_spi_di_L2_results$coefficients),
estimate = fe_spi_di_L2_results$coefficients[, "Estimate"],
std.error = fe_spi_di_L2_results$coefficients[, "Std. Error"]
)
# Create a ggplot error bar chart
ggplot(coef_df, aes(x = term, y = estimate)) +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
labs(title = "Lagged Effects in FE Model (SPI ~ DI)", x = "Terms", y = "Coefficient Estimate") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Save the plot
#ggsave("figures/error_bar_fe_spi_di_L2.png", width = 10, height = 6)
# Chunk 10
# Extract coefficients and robust standard errors from the FD model
fd_spi_di_L2_results <- summary(fd_spi_di_L2, vcov = vcovHC(fd_spi_di_L2, cluster = "group", type = "HC1"))
# Create a data frame for visualization
coef_fd_df <- data.frame(
term = rownames(fd_spi_di_L2_results$coefficients),
estimate = fd_spi_di_L2_results$coefficients[, "Estimate"],
std.error = fd_spi_di_L2_results$coefficients[, "Std. Error"]
)
# Create a ggplot error bar chart
ggplot(coef_fd_df, aes(x = term, y = estimate)) +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
labs(title = "Lagged Effects in FD Model (SPI ~ DI)", x = "Terms", y = "Coefficient Estimate") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Save the plot
#ggsave("figures/error_bar_fd_spi_di_L2", width = 10, height = 6)
# Chunk 11
# APPLY Wooldridge Test for AR(1) Errors in FE Panel Models: pwartest()
# https://search.r-project.org/CRAN/refmans/plm/html/pwartest.html
# This is MUCH BETTER for panel data with small T AND unbalanced panels!!!
pwartest(fe_spi_di_base) # [significant]
# Chunk 1
# set working directory
setwd("~/Documents/GitHub/QMSS_Thesis_Sanchez")
#load libraries/packages
source("packages.R")
# load data
source("Comp2_panel_wrangling.R")
# select path = "data/Main CSV Outputs/merged_cleaned_sdg.csv"
panel_data_s1 <- panel_data %>%
dplyr::select(country_name, country_code, year, spi_comp, di_score, di_score_lag1, di_score_lag2, log_gdppc, spi_comp_lag1, spi_comp_lag2, income_level_recoded) %>%
dplyr::arrange(country_code, year)
head(panel_data_s1)
# check lag structure is correct
head(panel_data_s1[, c("country_code", "year", "spi_comp", "spi_comp_lag1", "spi_comp_lag2",  "di_score", "di_score_lag1", "di_score_lag2")])
dim(panel_data_s1) # 1336 rows, 11 columns
# Chunk 2
# Contemporaneous Effect: SPI ~ DI
ols_spi_di <- plm(
formula = spi_comp ~ di_score + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
model = "pooling",
data = panel_data_s1)
summary(ols_spi_di, vcov = vcovHC(ols_spi_di, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
ols_spi_di_L1 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
model = "pooling",
data = panel_data_s1)
summary(ols_spi_di_L1, vcov = vcovHC(ols_spi_di_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
ols_spi_di_L2 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + di_score_lag2 + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
model = "pooling",
data = panel_data_s1)
summary(ols_spi_di_L2, vcov = vcovHC(ols_spi_di_L2, cluster = "group", type = "HC1"))
# Chunk 3
# --- POLS MODELS TABLE ---
# Extracting robust standard errors for the two POLS models
rob_se_pols <- list(
coeftest(ols_spi_di, vcov = vcovHC(ols_spi_di, cluster = "group", type = "HC1"))[, 2],
coeftest(ols_spi_di_L1, vcov = vcovHC(ols_spi_di_L1, cluster = "group", type = "HC1"))[, 2],
coeftest(ols_spi_di_L2, vcov = vcovHC(ols_spi_di_L2, cluster = "group", type = "HC1"))[, 2]
)
# Generate the stargazer table for POLS models
stargazer(
ols_spi_di, ols_spi_di_L1, ols_spi_di_L2,
se = rob_se_pols,
type = "html",
out = "figures/s1_pols_lags.html",
title = "Stage I Models: Pooled OLS (Current and Lagged Effects)",
align = TRUE,
dep.var.labels = "SPI Overall Score",
column.labels = c("Contemporaneous", "Lag 1", "Lag 2"),
covariate.labels = c("DI Composite", "Lagged DI (t-1)", "Lagged DI (t-2)",  "Log(GDPper-capita)", "Lower-Middle Income (LMIC)", "Upper-Middle Income (UMIC)", "High Income (HIC)", "Intercept"),
report = "vcs*",
notes = "Robust standard errors clustered by country in parentheses",
omit = "factor\\(year\\)",
model.names = FALSE
)
# Chunk 4
# Contemporaneous Effect: SPI ~ DI
fd_spi_di <- plm(
formula = spi_comp ~ di_score + log_gdppc +  factor(income_level_recoded),
index = c("country_code", "year"),
data = fd_data,
model = "fd"
)
summary(fd_spi_di, vcov = vcovHC(fd_spi_di, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
fd_spi_di_L1 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + log_gdppc + factor(income_level_recoded),
index = c("country_code", "year"),
data = fd_data,
model = "fd"
)
summary(fd_spi_di_L1, vcov = vcovHC(fd_spi_di_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fd_spi_di_L2 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + di_score_lag2 + log_gdppc + factor(income_level_recoded),
index = c("country_code", "year"),
data = fd_data,
model = "fd"
)
summary(fd_spi_di_L2, vcov = vcovHC(fd_spi_di_L2, cluster = "group", type = "HC1"))
# Chunk 5
# --- FD MODELS TABLE ---
# extracting robust standard errors for the three FD models
rob_se_fd <- list(
coeftest(fd_spi_di, vcov = vcovHC(fd_spi_di, cluster = "group", type = "HC1"))[, 2],
coeftest(fd_spi_di_L1, vcov = vcovHC(fd_spi_di_L1, cluster = "group", type = "HC1"))[, 2],
coeftest(fd_spi_di_L2, vcov = vcovHC(fd_spi_di_L2, cluster = "group", type = "HC1"))[, 2]
)
# stargazer table for FD models
stargazer(
fd_spi_di, fd_spi_di_L1, fd_spi_di_L2,
se = rob_se_fd,
type = "html",
out = "figures/s1_fd_lags.html",
title = "Stage I Models: First Difference (Current and Lagged Effects)",
align = TRUE,
dep.var.labels = "SPI Overall Score",
column.labels = c("Contemporaneous", "Lag 1", "Lag 2"),
covariate.labels = c("DI Composite", "Lagged DI (t-1)", "Lagged DI (t-2)",  "Log(GDPper-capita)", "Lower-Middle Income (LMIC)", "Upper-Middle Income (UMIC)", "High Income (HIC)", "Intercept"),
report = "vcs*",
notes = "Robust standard errors clustered by country in parentheses",
omit = "factor\\(year\\)",
model.names = FALSE
)
# Chunk 6
# Contemporaneous Effect: SPI ~ DI
fe_spi_di <- plm(
formula = spi_comp ~ di_score + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
data = panel_data_s1,
model = "within")
summary(fe_spi_di, vcov = vcovHC(fe_spi_di, cluster = "group", type = "HC1"))
# Adding Lag1: SPI ~ DI
fe_spi_di_L1 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
data = panel_data_s1,
model = "within")
summary(fe_spi_di_L1, vcov = vcovHC(fe_spi_di_L1, cluster = "group", type = "HC1"))
# Adding Lag2: SPI ~ DI
fe_spi_di_L2 <- plm(
formula = spi_comp ~ di_score + di_score_lag1 + di_score_lag2 + log_gdppc + factor(income_level_recoded) + factor(year),
index = c("country_code", "year"),
data = panel_data_s1,
model = "within")
summary(fe_spi_di_L2, vcov = vcovHC(fe_spi_di_L2, cluster = "group", type = "HC1"))
# Chunk 7
# --- FE MODELS TABLE ---
# Extracting robust standard errors for the three FE models
rob_se_fe <- list(
coeftest(fe_spi_di, vcov = vcovHC(fe_spi_di, cluster = "group", type = "HC1"))[, 2],
coeftest(fe_spi_di_L1, vcov = vcovHC(fe_spi_di_L1, cluster = "group", type = "HC1"))[, 2],
coeftest(fe_spi_di_L2, vcov = vcovHC(fe_spi_di_L2, cluster = "group", type = "HC1"))[, 2]
)
# stargazer table for FE models
stargazer(
fe_spi_di, fe_spi_di_L1, fe_spi_di_L2,
se = rob_se_fe,
type = "html",
out = "figures/s1_fe_lags.html",
title = "Stage I Models: Fixed Effects (Current and Lagged Effects)",
align = TRUE,
dep.var.labels = "SPI Overall Score",
column.labels = c("Contemporaneous", "Lag 1", "Lag 2"),
covariate.labels = c("DI Composite", "Lagged DI (t-1)", "Lagged DI (t-2)",  "Log(GDPper-capita)", "Lower-Middle Income (LMIC)", "Upper-Middle Income (UMIC)", "High Income (HIC)", "Intercept"),
report = "vcs*",
notes = "Robust standard errors clustered by country in parentheses",
omit = "factor\\(year\\)",
model.names = FALSE
)
# Chunk 8
# stargazer table for only lag2 models
stargazer(
ols_spi_di_L2, fd_spi_di_L2, fe_spi_di_L2,
se = list(
coeftest(ols_spi_di_L2, vcov = vcovHC(ols_spi_di_L2, cluster = "group", type = "HC1"))[, 2],
coeftest(fd_spi_di_L2, vcov = vcovHC(fd_spi_di_L2, cluster = "group", type = "HC1"))[, 2],
coeftest(fe_spi_di_L2, vcov = vcovHC(fe_spi_di_L2, cluster = "group", type = "HC1"))[, 2]
),
type = "html",
title = "Stage I Models: Lagged Effects (Lag 2)",
align = TRUE,
dep.var.labels = "SPI Overall Score",
column.labels = c("POLS", "FD", "FE"),
covariate.labels = c("DI Composite", "Lagged DI (t-1)", "Lagged DI (t-2)",  "Log(GDPper-capita)", "Lower-Middle Income (LMIC)", "Upper-Middle Income (UMIC)", "High Income (HIC)", "Intercept"),
report = "vcs*",
notes = "Robust standard errors clustered by country in parentheses",
omit = "factor\\(year\\)",
model.names = FALSE,
out = "figures/s1_lag2_mods.html"
)
# Chunk 9
# Extract coefficients and robust standard errors from the FE model
fe_spi_di_L2_results <- summary(fe_spi_di_L2, vcov = vcovHC(fe_spi_di_L2, cluster = "group", type = "HC1"))
# Create a data frame for visualization
coef_df <- data.frame(
term = rownames(fe_spi_di_L2_results$coefficients),
estimate = fe_spi_di_L2_results$coefficients[, "Estimate"],
std.error = fe_spi_di_L2_results$coefficients[, "Std. Error"]
)
# Create a ggplot error bar chart
ggplot(coef_df, aes(x = term, y = estimate)) +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
labs(title = "Lagged Effects in FE Model (SPI ~ DI)", x = "Terms", y = "Coefficient Estimate") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Save the plot
#ggsave("figures/error_bar_fe_spi_di_L2.png", width = 10, height = 6)
# Chunk 10
# Extract coefficients and robust standard errors from the FD model
fd_spi_di_L2_results <- summary(fd_spi_di_L2, vcov = vcovHC(fd_spi_di_L2, cluster = "group", type = "HC1"))
# Create a data frame for visualization
coef_fd_df <- data.frame(
term = rownames(fd_spi_di_L2_results$coefficients),
estimate = fd_spi_di_L2_results$coefficients[, "Estimate"],
std.error = fd_spi_di_L2_results$coefficients[, "Std. Error"]
)
# Create a ggplot error bar chart
ggplot(coef_fd_df, aes(x = term, y = estimate)) +
geom_point() +
geom_errorbar(aes(ymin = estimate - std.error, ymax = estimate + std.error), width = 0.2) +
labs(title = "Lagged Effects in FD Model (SPI ~ DI)", x = "Terms", y = "Coefficient Estimate") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Save the plot
#ggsave("figures/error_bar_fd_spi_di_L2", width = 10, height = 6)
# Chunk 11
# APPLY Wooldridge Test for AR(1) Errors in FE Panel Models: pwartest()
# https://search.r-project.org/CRAN/refmans/plm/html/pwartest.html
# This is MUCH BETTER for panel data with small T AND unbalanced panels!!!
pwartest(fe_spi_di_L2) # [significant]
# Chunk 12
# Apply Breusch-Pagan test for heteroskedasticity
bptest(fe_spi_di_L2, studentize = TRUE) # Heteroskedasticity [significant]
bptest(fd_spi_di_L2, studentize = TRUE) # Heteroskedasticity [significant]
